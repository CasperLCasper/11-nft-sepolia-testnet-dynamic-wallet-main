<!DOCTYPE html>
<html lang="lv">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dynamic Wallet Visualizer — Sepolia NFT Access</title>

  <!-- Font -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />

  <style>
    body { font-family:'Inter',Arial,sans-serif; background:#000; color:#fff; margin:0; padding:20px; position: relative; }
    .container { max-width:1400px; margin:auto; display:flex; flex-direction:column; align-items:center; gap:12px; }
    h1 { font-size:36px; margin:0; line-height:1; background:linear-gradient(90deg,#ffffff,#aaaaaa); -webkit-background-clip:text; -webkit-text-fill-color:transparent; text-align:center; }
    .subtitle { margin-top:4px; color:#9fb0c3; font-size:18px; text-align:center; }
    .controls { display:flex; gap:10px; flex-wrap:wrap; justify-content:center; }
    button { padding:12px 20px; border-radius:12px; border:none; cursor:pointer; background:linear-gradient(90deg,#4a90e2,#9013fe); color:#fff; font-weight:700; font-size:16px; box-shadow:0 6px 18px rgba(0,0,0,0.45); transition: transform 0.2s, box-shadow 0.2s; }
    button:disabled { background:#444; cursor:not-allowed; box-shadow:0 6px 18px rgba(0,0,0,0.2); }
    button:hover:not(:disabled) { transform:translateY(-4px) scale(1.03); box-shadow:0 8px 22px rgba(0,0,0,0.65); }
    .snapshot-container { width:100%; background:#000; border-radius:14px; padding:18px; box-shadow:0 12px 40px rgba(0,0,0,0.6); position:relative; }
    #snapshotCanvas { width:100%; border-radius:10px; border:1px solid rgba(255,255,255,0.03); display:block; margin-bottom:12px; }
    #recordTimer { margin-top:6px; color:#0ff; font-weight:600; font-size:16px; text-align:center; }
    #statusContainer { position: relative; width: 100%; height: 40px; margin-top: 8px; }
    .status { font-weight:600; font-size:16px; color:#fff; line-height:40px; text-align:center; }
    #progressBarContainer { position: absolute; top: 50%; left: 50%; width: 60%; height: 18px; background: rgba(255,255,255,0.1); border-radius: 6px; transform: translate(-50%, -50%); display: none; overflow: hidden; }
    #progressBar { height: 100%; width: 100%; background: linear-gradient(90deg,#0ff,#4a90e2); border-radius: 6px; transform: scaleX(0); transform-origin: left center; transition: transform 0.4s ease; }
    #overlay { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.7); z-index:999; }
    #recordDropdown { display:none; position: fixed; top:50%; left:50%; transform:translate(-50%,-50%); background:#111; border:2px solid #555; border-radius:12px; padding:80px 20px 20px 20px; z-index:1000; min-width:360px; box-shadow:0 8px 24px rgba(0,0,0,0.7); text-align:center; overflow-y:auto; }
    #recordDropdown button { width:100%; margin:16px 0; }
    #dropdownClose { position:absolute; top:10px; right:10px; cursor:pointer; font-size:28px; font-weight:bold; color:#fff; background:none; border:none; padding:0; line-height:1; }
    #fullscreenIcon { position:absolute; top:10px; right:10px; display:flex; align-items:center; cursor:pointer; color:#0ff; background:rgba(0,0,0,0.3); border-radius:6px; padding:6px 10px; transition: background 0.2s, transform 0.2s; z-index:10; user-select:none; }
    #fullscreenIcon:hover { background:rgba(0,255,255,0.2); transform: scale(1.05); }
    #fullscreenText { font-family:'Inter',Arial,sans-serif; white-space: nowrap; margin-left:6px; font-size:16px; font-weight:600; }
    #toggleInfoIcon { position:absolute; top:10px; left:10px; display:flex; align-items:center; cursor:pointer; color:#0ff; background:rgba(0,0,0,0.3); border-radius:6px; padding:6px 10px; transition: background 0.2s, transform 0.2s; z-index:10; user-select:none; }
    #toggleInfoIcon:hover { background:rgba(0,255,255,0.2); transform: scale(1.05); }
    #infoText { font-family:'Inter',Arial,sans-serif; white-space: nowrap; margin-left:6px; font-size:16px; font-weight:600; }
    #accountDisplay { width:100%; word-break:break-word; margin-top:8px; font-size:16px; text-align:center; }

    #tokenListContainer {
      display:none;
      position:absolute;
      top:80px;
      left:10px;
      max-height:150px;
      width:90%;
      max-width:576px;
      background:rgba(0,0,0,0.5);
      border-radius:9px;
      overflow-y:auto;
      padding:10px;
      color:#fff;
      font-family:'Inter',Arial,sans-serif;
      font-size:14px;
      z-index:15;
    }
    #tokenListContainer table { width:100%; border-collapse:collapse; }
    #tokenListContainer th, #tokenListContainer td { padding:6px 8px; text-align:left; font-size:13px; }
    #tokenListContainer th { color:#0ff; font-weight:600; }
    #tokenListContainer tr:nth-child(even) td { background:rgba(255,255,255,0.05); }
    #tokenListContainer tr:nth-child(odd) td { background:rgba(255,255,255,0.02); }
    #tokenListContainer::-webkit-scrollbar { width:6px; }
    #tokenListContainer::-webkit-scrollbar-thumb { background:#0ff; border-radius:3px; }
    #tokenListContainer::-webkit-scrollbar-track { background:#222; border-radius:3px; }
  </style>
</head>

<body>
  <div class="container" role="main">
    <header class="site-header">

        <img 
            src="data:image/png;base64,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"
            alt="Logo"
            class="logo"
        >

        <div class="header-text">
            <h1>Dynamic Wallet Visualizer</h1>
            <p class="subtitle">Watch your Ethereum assets come alive — Sepolia NFT Access</p>
        </div>

    </header>

    <section class="controls" aria-label="Controls">
      <button id="connectBtn">Connect Wallet</button>
      <button id="renderBtn" disabled>Render Snapshot</button>
      <button id="recordBtn" disabled>Record 20s HD Video</button>
    </section>

    <div id="accountDisplay" aria-live="polite">Connected account: —</div>
    <div id="statusContainer" aria-hidden="false">
      <div id="statusMsg" class="status" role="status" aria-live="polite"></div>
      <div id="progressBarContainer" aria-hidden="true"><div id="progressBar"></div></div>
    </div>
    <div id="recordTimer" aria-live="polite">Recording: 0 / 20 s</div>

    <section class="snapshot-container" aria-label="Snapshot">
      <canvas id="snapshotCanvas" width="1920" height="1080" aria-label="Visualization canvas"></canvas>
      <div id="fullscreenIcon" role="button" tabindex="0" aria-label="Toggle fullscreen">⤢ <span id="fullscreenText">Fullscreen</span></div>
      <div id="toggleInfoIcon" role="button" tabindex="0" aria-label="Toggle info">ℹ <span id="infoText">Info</span></div>

      <div id="tokenListContainer" aria-hidden="true">
        <table>
          <thead><tr><th>Address</th><th>Balance</th></tr></thead>
          <tbody id="tokenListContent"></tbody>
        </table>
      </div>
    </section>
  </div>

  <div id="overlay" tabindex="-1"></div>

  <div id="recordDropdown" role="dialog" aria-modal="true" aria-hidden="true">
    <button id="dropdownClose" aria-label="Close">&times;</button>
    <button id="recordWithTokensBtn">Record video with token list</button>
    <button id="recordWithoutTokensBtn">Record video without token list</button>
  </div>

  <!-- External libs -->
  <script src="https://cdn.jsdelivr.net/npm/ethers@6/dist/ethers.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@walletconnect/web3-provider@1.8.0/dist/umd/index.min.js"></script>

  <script>
    // ===== Canvas setup =====
    const isMobile = /Mobi|Android/i.test(navigator.userAgent);
    const canvas = document.getElementById('snapshotCanvas');
    const ctx = canvas.getContext('2d');
    function resizeCanvas() {
      const dpr = window.devicePixelRatio || 1;
      const scale = isMobile ? 0.6 : 1;
      canvas.width = Math.round(1920*dpr*scale);
      canvas.height = Math.round(1080*dpr*scale);
      canvas.style.width = '100%';
      canvas.style.height = 'auto';
      ctx.setTransform(1,0,0,1,0,0);
      ctx.scale(dpr*scale, dpr*scale);
    }
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    // ===== Variables =====
    const NFT_CONTRACT = "0x1EF02c3Ed33a98c10F0bf1fd71e4D226e8e408A5";
    const providerRpcUrl = "https://eth-sepolia.g.alchemy.com/v2/YOUR_ALCHEMY_KEY";
    let provider, signer, account, wcProvider;
    let showInfo = true;
    let tokens=[], ethBalance=0, txCount=0, particles=[], initialParticles=[], animRequest=null;
    let walletSeed=0;

    const connectBtn = document.getElementById('connectBtn');
    const renderBtn = document.getElementById('renderBtn');
    const recordBtn = document.getElementById('recordBtn');
    const accountDisplay = document.getElementById('accountDisplay');
    const recordTimer = document.getElementById('recordTimer');
    const statusMsg = document.getElementById('statusMsg');
    const overlay = document.getElementById('overlay');
    const recordDropdown = document.getElementById('recordDropdown');
    const dropdownClose = document.getElementById('dropdownClose');
    const recordWithTokensBtn = document.getElementById('recordWithTokensBtn');
    const recordWithoutTokensBtn = document.getElementById('recordWithoutTokensBtn');
    const fullscreenIcon = document.getElementById('fullscreenIcon');
    const toggleInfoIcon = document.getElementById('toggleInfoIcon');
    const progressBarContainer = document.getElementById('progressBarContainer');
    const progressBar = document.getElementById('progressBar');
    const tokenListContainer = document.getElementById('tokenListContainer');
    const tokenListContent = document.getElementById('tokenListContent');

    // ===== Helpers =====
    function showProgressSmooth(){ progressBarContainer.style.display='block'; progressBar.style.transform='scaleX(0)'; }
    function hideProgressSmooth(){ progressBar.style.transform='scaleX(1)'; setTimeout(()=>{progressBarContainer.style.display='none'; progressBar.style.transform='scaleX(0)';},500); }
    function hashStringToInt(str,mod=1000){ let h=2166136261>>>0; for(let i=0;i<str.length;i++){h^=str.charCodeAt(i);h=Math.imul(h,16777619)>>>0;} return h%mod; }
    function seededRandomFloat(seedStr){ return hashStringToInt(seedStr,10000)/10000; }

    // ===== Particles =====
    async function initParticlesOnce(){
      initialParticles=[];
      const particleCount = Math.min(150,50+(tokens.length||0)*15);
      const seedBase = (account||'')+String(ethBalance)+String(txCount);
      for(let i=0;i<particleCount;i++){
        const t = tokens.length ? tokens[i%tokens.length] : {balance:1,address:String(i),symbol:'T'};
        const balanceFactor = t.isNFT ? 1 : Math.min(t.balance||0,20)/20;
        let hue = hashStringToInt((t.address||'')+seedBase+i)%360;
        const ethFactor = Math.min(ethBalance/10,1); hue=(hue+ethFactor*100)%360;
        const speed=0.005+0.01*(hashStringToInt((t.symbol||t.address)+seedBase+i,10)/10);
        const r=t.isNFT?10:2+6*balanceFactor;
        const angle=seededRandomFloat(seedBase+i+'angle')*2*Math.PI;
        const radius=50+seededRandomFloat(seedBase+i+'radius')*400;
        initialParticles.push({angle,radius,r,hue,speed,token:t});
      }
    }
    function cloneParticles(){ return initialParticles.map(p=>({...p})); }

    // ===== Draw frame =====
    function drawFrame(frame,showTokensFrame){
      const dpr = window.devicePixelRatio || 1;
      const scale = isMobile ? 0.6 : 1;
      const W = canvas.width/(dpr*scale);
      const H = canvas.height/(dpr*scale);
      ctx.clearRect(0,0,W,H);
      ctx.fillStyle='#000'; ctx.fillRect(0,0,W,H);
      const cx0=W/2, cy0=H/2;

      for(let i=0;i<particles.length;i++){
        for(let j=i+1;j<particles.length;j++){
          const p1=particles[i], p2=particles[j];
          const x1=cx0+Math.cos(p1.angle)*p1.radius;
          const y1=cy0+Math.sin(p1.angle)*p1.radius;
          const x2=cx0+Math.cos(p2.angle)*p2.radius;
          const y2=cy0+Math.sin(p2.angle)*p2.radius;
          const dx=x1-x2, dy=y1-y2;
          const dist=Math.sqrt(dx*dx+dy*dy);
          if(dist<120){
            const avgBalance=(Math.min(p1.token.balance,20)+Math.min(p2.token.balance,20))/40;
            const alpha=0.2+0.4*avgBalance*(1-dist/200);
            ctx.lineWidth=1.5+2*avgBalance;
            const txFactor=Math.log(txCount+1)/10;
            const hue=(p1.hue+p2.hue)/2+frame*0.4*txFactor;
            ctx.strokeStyle=`hsla(${hue},100%,70%,${alpha})`;
            ctx.beginPath(); ctx.moveTo(x1,y1); ctx.lineTo(x2,y2); ctx.stroke();
          }
        }
      }

      particles.forEach(p=>{
        p.angle+=p.speed;
        const cx=cx0+Math.cos(p.angle)*p.radius;
        const cy=cy0+Math.sin(p.angle)*p.radius;
        const gradient=ctx.createRadialGradient(cx,cy,0,cx,cy,p.r*2.5);
        gradient.addColorStop(0,`hsla(${p.hue},100%,70%,1)`);
        gradient.addColorStop(0.5,`hsla(${p.hue+20},100%,60%,0.9)`);
        gradient.addColorStop(1,`hsla(${p.hue+40},100%,40%,0.5)`);
        ctx.fillStyle=gradient; ctx.beginPath(); ctx.arc(cx,cy,p.r,0,Math.PI*2); ctx.fill();
      });

      if(showTokensFrame && showInfo){
        ctx.fillStyle='#0ff';
        ctx.font='22px Inter';
        ctx.fillText(`SepoliaETH: ${ethBalance.toFixed(4)}`,10,80);
      }
    }

    // ===== Token UI =====
    function updateTokenListUI() {
      if(!tokens || tokens.length===0){ tokenListContent.innerHTML='<tr><td colspan="2" style="color:#777;">No tokens</td></tr>'; return; }
      tokenListContent.innerHTML='';
      tokens.forEach(t=>{
        const tr=document.createElement('tr');
        const addrTd=document.createElement('td'); addrTd.textContent=t.address; addrTd.title=t.address;
        const balTd=document.createElement('td'); balTd.textContent=t.balance.toFixed(4);
        tr.appendChild(addrTd); tr.appendChild(balTd);
        tokenListContent.appendChild(tr);
      });
    }

    // ===== Wallet & NFT =====
    async function checkNFTAccess(){
      if(!account) return false;
      showProgressSmooth();
      try{
        const res=await fetch(`/api/getNFTs?account=${encodeURIComponent(account)}`);
        const data=await res.json();
        return data?.ownsNFT===true;
      }catch(err){ console.error(err); return false; }
      finally{ hideProgressSmooth(); }
    }

    async function getTokens(){
      if(!account) return [];
      showProgressSmooth();
      try{
        const res=await fetch(`/api/getTokens?account=${encodeURIComponent(account)}`);
        if(!res.ok){ statusMsg.textContent='Token API unavailable — fallback'; return []; }
        const data=await res.json();
        if(!data?.result?.tokenBalances) return [];
        return data.result.tokenBalances.map(t=>{
          const decimals=t.tokenDecimals!=null?Number(t.tokenDecimals):18;
          const balance=Number(ethers.formatUnits(t.tokenBalance||"0x0",decimals));
          const address=(t.tokenAddress||t.contractAddress||"").toLowerCase();
          return {address,balance,symbol:t.symbol||address};
        }).filter(t=>t.balance>0);
      }catch(e){ console.error(e); statusMsg.textContent='Failed fetching tokens'; return []; }
      finally{ hideProgressSmooth(); }
    }

    async function getAllNFTs(){
      if(!account) return [];
      showProgressSmooth();
      try{
        const res=await fetch(`/api/getAllNFTs?account=${encodeURIComponent(account)}`);
        if(!res.ok) return [];
        const data=await res.json();
        if(!data?.nfts) return [];
        return data.nfts.map(nft=>({
          address:nft.contract.address,
          symbol:nft.contract.symbol||'NFT',
          balance:1,
          isNFT:true,
          tokenId:nft.id.tokenId
        }));
      }catch(e){ console.error(e); return []; }
      finally{ hideProgressSmooth(); }
    }

    // ===== Connect Wallet =====
    async function connectWallet(){
      showProgressSmooth();
      try{
        if(window.ethereum){
          provider=new ethers.BrowserProvider(window.ethereum,"sepolia");
          await provider.send("eth_requestAccounts",[]);
          signer=await provider.getSigner();
          account=await signer.getAddress();
        } else {
          wcProvider=new WalletConnectProvider.default({ rpc:{11155111:providerRpcUrl} });
          await wcProvider.enable();
          provider=new ethers.BrowserProvider(wcProvider,"sepolia");
          signer=await provider.getSigner();
          account=await signer.getAddress();
        }

        accountDisplay.textContent='Connected account: '+account;
        walletSeed=hashStringToInt(account);

        const hasNFT = await checkNFTAccess();
        if(hasNFT){
          renderBtn.disabled=false;
          recordBtn.disabled=false;
          statusMsg.textContent='Wallet connected & NFT verified — access granted.';
        } else {
          renderBtn.disabled=true;
          recordBtn.disabled=true;
          statusMsg.textContent='NFT not found — access denied.';
          alert('Access denied — required NFT not found.');
        }

      }catch(err){
        console.error(err);
        statusMsg.textContent='Wallet connection failed.';
        alert('Wallet connection failed. Retry.');
      }finally{ hideProgressSmooth(); }
    }

    // ===== Render Snapshot =====
    async function renderSnapshot(){
      if(!account) await connectWallet();
      if(!provider || !account){ statusMsg.textContent='Wallet not connected.'; return; }

      stopAnimation();
      showProgressSmooth();
      progressBar.style.transform='scaleX(0)';
      statusMsg.textContent='';

      const steps=[
        {name:'Fetching ETH balance', func: async()=>{ ethBalance=Number(ethers.formatEther(await provider.getBalance(account)))||0; }},
        {name:'Fetching transaction count', func: async()=>{ txCount=Number(await provider.getTransactionCount(account))||0; }},
        {name:'Fetching tokens', func: async()=>{ tokens=[...await getTokens()]; }},
        {name:'Fetching NFTs', func: async()=>{ tokens=[...tokens,...await getAllNFTs()]; }},
        {name:'Initializing particles', func: async()=>{ await initParticlesOnce(); particles=cloneParticles(); }}
      ];

      let currentStep=0, totalSteps=steps.length;
      let visualProgress=0, running=true;

      function animateProgress(){
        if(!running) return;
        const targetProgress=currentStep/totalSteps;
        visualProgress+=(targetProgress-visualProgress)*0.05;
        progressBar.style.transform=`scaleX(${visualProgress})`;
        requestAnimationFrame(animateProgress);
      }
      requestAnimationFrame(animateProgress);

      try{
        for(const step of steps){
          statusMsg.textContent=step.name+'...';
          await step.func();
          currentStep++;
        }

        if(showInfo){ tokenListContainer.style.display='block'; updateTokenListUI(); }

        running=false; progressBar.style.transform='scaleX(1)'; statusMsg.textContent='Visualization running!';
        hideProgressSmooth();
        animate();
      }catch(e){ running=false; hideProgressSmooth(); console.error(e); statusMsg.textContent='Error rendering visualization.'; alert('Render failed. Check console.'); }
    }

    // ===== Animation =====
    function animate(frame=0){ drawFrame(frame,true); animRequest=requestAnimationFrame(()=>animate(frame+1)); }
    function stopAnimation(){ if(animRequest) cancelAnimationFrame(animRequest); animRequest=null; }

    // ===== Event Listeners =====
    connectBtn.addEventListener('click', connectWallet);
    renderBtn.addEventListener('click', renderSnapshot);
    fullscreenIcon.addEventListener('click', ()=>{ if(!document.fullscreenElement) canvas.requestFullscreen().catch(()=>{}); else document.exitFullscreen().catch(()=>{}); });
    toggleInfoIcon.addEventListener('click', ()=>{
      showInfo=!showInfo;
      document.getElementById('infoText').textContent=showInfo?'Info':'Hidden';
      tokenListContainer.style.display=showInfo?'block':'none';
      if(showInfo) updateTokenListUI();
    });

    // ===== Video Recording =====
    function pickSupportedMimeType(){
      const candidates=['video/webm;codecs=vp9','video/webm;codecs=vp8','video/webm','video/mp4'];
      for(const c of candidates){ try{ if(MediaRecorder.isTypeSupported && MediaRecorder.isTypeSupported(c)) return c; }catch(e){} }
      return '';
    }

    async function startRecording(includeTokens=false){
      if(startRecording._recording) return;
      startRecording._recording=true;
      const previousShowInfo=showInfo;
      showInfo=false;
      if(includeTokens){ tokenListContainer.style.display='block'; document.getElementById('infoText').textContent='Info'; }
      stopAnimation(); particles=cloneParticles(); drawFrame(0,true);
      statusMsg.textContent='Preparing recording...';
      recordBtn.disabled=true; renderBtn.disabled=true; connectBtn.disabled=true;
      showProgressSmooth(); if(!animRequest) animate();

      let stream; try{ stream=canvas.captureStream(30); }catch(err){ statusMsg.textContent='Recording not supported.'; cleanup(); return; }

      const mime=pickSupportedMimeType(); let recorder;
      try{ recorder=mime?new MediaRecorder(stream,{mimeType:mime}):new MediaRecorder(stream); }catch(err){ alert('MediaRecorder not available.'); cleanup(); return; }

      const chunks=[]; recorder.ondataavailable=(e)=>{ if(e.data&&e.data.size) chunks.push(e.data); };
      recorder.onerror=(ev)=>{ console.error(ev); statusMsg.textContent='Recording error.'; };
      recorder.onstart=()=>{ statusMsg.textContent='Recording...'; };
      recorder.start();

      const startTime=performance.now(), duration=20000;
      function updateProgress(timestamp){
        const elapsed=timestamp-startTime;
        const progress=Math.min(elapsed/duration,1);
        progressBar.style.transform=`scaleX(${progress})`;
        const seconds=Math.floor(elapsed/1000);
        recordTimer.textContent=`Recording: ${seconds} / 20 s`;
        if(elapsed<duration) requestAnimationFrame(updateProgress); else try{ recorder.stop(); }catch(e){}
      }
      requestAnimationFrame(updateProgress);

      recorder.onstop=()=>{
        const blob=new Blob(chunks,{type:chunks.length?chunks[0].type:'video/webm'});
        const url=URL.createObjectURL(blob);
        const a=document.createElement('a'); a.style.display='none'; a.href=url;
        const ext=blob.type.includes('mp4')?'mp4':'webm';
        a.download=`wallet_visualization.${ext}`; document.body.appendChild(a); a.click();
        setTimeout(()=>{document.body.removeChild(a); URL.revokeObjectURL(url);},100);
        showInfo=previousShowInfo;
        document.getElementById('infoText').textContent=showInfo?'Info':'Hidden';
        tokenListContainer.style.display=showInfo?'block':'none';
        updateTokenListUI();
        statusMsg.textContent='Recording finished!'; recordTimer.textContent='Recording: 0 / 20 s';
        hideProgressSmooth(); recordBtn.disabled=false; renderBtn.disabled=false; connectBtn.disabled=false;
        startRecording._recording=false;
      };

      function cleanup(){
        try{ if(recorder && recorder.state==='recording') recorder.stop(); }catch(e){}
        showInfo=previousShowInfo;
        document.getElementById('infoText').textContent=showInfo?'Info':'Hidden';
        tokenListContainer.style.display=showInfo?'block':'none';
        updateTokenListUI();
        recordBtn.disabled=false; renderBtn.disabled=false; connectBtn.disabled=false;
        hideProgressSmooth(); recordTimer.textContent='Recording: 0 / 20 s';
        startRecording._recording=false;
      }
    }

    recordBtn.addEventListener('click',()=>startRecording(true));
  </script>
</body>
</html>

















































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































